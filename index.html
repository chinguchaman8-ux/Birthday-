<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Happy Birthday Sakshii! ğŸ‰âœ¨</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Inter:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    /* Fonts */
    .font-pacifico { font-family: 'Pacifico', cursive; }
    .font-inter { font-family: 'Inter', sans-serif; }

    /* Confetti animation */
    #confetti-container { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; overflow: hidden; z-index: 10; }
    .confetti {
      position: absolute; 
      width: 10px; height: 10px; border-radius: 50%;
      animation: confetti-fall 8s linear infinite;
    }
    @keyframes confetti-fall {
      0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0.5; }
    }

    /* Text gradient and sparkle */
    .gradient-text {
      background: linear-gradient(45deg, #ff7e5f, #feb47b, #ff7e5f);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-size: 200% 200%;
      animation: shimmer 4s ease-in-out infinite;
    }
    @keyframes shimmer {
      0% { background-position: 0% 50%; }
      100% { background-position: 100% 50%; }
    }
    @keyframes sparkle-pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.03); }
      100% { transform: scale(1); }
    }
    .sparkle-pulse { animation: sparkle-pulse 2s ease-in-out infinite alternate; }

    /* Button styles */
    button:focus { outline: none; box-shadow: 0 0 0 4px rgba(236 72 153 / 0.6); }

    /* Slide in left & right animations for image rows */
    @keyframes slideInLeft {
      0% { opacity: 0; transform: translateX(-80px); }
      100% { opacity: 1; transform: translateX(0); }
    }
    @keyframes slideInRight {
      0% { opacity: 0; transform: translateX(80px); }
      100% { opacity: 1; transform: translateX(0); }
    }

    .image-row {
      opacity: 0;
      animation-fill-mode: forwards;
      animation-duration: 0.7s;
      animation-timing-function: cubic-bezier(0.36, 0.66, 0.04, 1);
    }
    .row-left { animation-name: slideInLeft; }
    .row-right { animation-name: slideInRight; }

    /* Caption bubble */
    .caption {
      font-size: 1.1rem;
      padding: 0.5rem 1rem;
      margin: 0 0.75rem;
      background: rgba(219 39 119 / 0.15);
      border-radius: 9999px;
      color: #db2777;
      font-weight: 600;
      white-space: nowrap;
      user-select: none;
      flex-shrink: 0;
    }

    /* Image styles */
    .slide-img {
      border-radius: 1rem;
      box-shadow: 0 6px 18px rgba(219 39 119 / 0.4);
      width: 160px;
      height: 160px;
      object-fit: cover;
      border: 4px solid #ec4899;
      flex-shrink: 0;
    }

    /* Collage Styles */
    #memory-flow-container.collage-grid {
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      margin: 0; padding: 1.5rem; 
      background-color: rgba(255 255 255 / 0.9);
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      grid-auto-rows: 160px;
      gap: 10px;
      overflow-y: auto;
      z-index: 50;
      animation: collageBlink 3s ease-in-out infinite;
    }
    #memory-flow-container.collage-grid .memory-card {
      box-shadow: none !important;
      border-radius: 0 !important;
      width: 100% !important;
      height: 100% !important;
    }
    #memory-flow-container.collage-grid .memory-card > div {
      width: 100%; height: 100%; border: 2px solid white;
      border-radius: 0; overflow: hidden;
    }
    #memory-flow-container.collage-grid .memory-card img {
      width: 100%; height: 100%; object-fit: cover;
      transition: transform 0.5s ease;
      border-radius: 0;
    }
    #memory-flow-container.collage-grid .caption {
      display: none !important;
    }
    .blinking-collage {
      box-shadow: 0 0 20px 8px rgba(236 72 153 / 0.35);
      border-radius: 1rem;
    }
    @keyframes collageBlink {
      0%, 100% { filter: brightness(1); }
      50% { filter: brightness(1.25) saturate(1.15); }
    }

    /* Overlay message */
    .overlay-message {
      position: fixed;
      inset: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      pointer-events: none;
      z-index: 60;
    }
    .overlay-message p {
      font-family: 'Pacifico', cursive;
      font-size: 3rem;
      padding: 1rem 2rem;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 1rem;
      color: white;
      animation: bounce 2s ease infinite;
      user-select: none;
    }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-24px); }
    }

    /* small play link */
    #play-music-link {
      display: inline-block;
      margin-left: 1rem;
      font-weight: 700;
      color: #fff;
      background: rgba(255,255,255,0.08);
      padding: 0.5rem 0.9rem;
      border-radius: 9999px;
      cursor: pointer;
      text-decoration: none;
      transition: transform .15s ease;
    }
    #play-music-link:active { transform: scale(.98); }
    /* feedback text */
    #audio-feedback { margin-left: 0.5rem; color: #6b21a8; font-weight: 700; }
  </style>
</head>
<body class="bg-pink-50 min-h-screen overflow-x-hidden relative">

  <!-- Confetti Background -->
  <div id="confetti-container"></div>

  <!-- Audio Player
       Notes:
       - Modern browsers block autoplay with audible sound unless the user has granted autoplay permissions.
       - To achieve autoplay across most browsers we autoplay muted, then unmute when the user interacts (click/tap).
       - The audio element is hidden so it runs in the background.
  -->
  <audio id="bday-music" loop preload="auto" playsinline autoplay muted style="display:none">
    <source src="#mkstatus07 #happyrakshabandhan #newwhatsappstatus Ladachi g premacha g ekulti ek whatsapp status (2).mp3" type="audio/mp3">
    Your browser does not support the audio element.
  </audio>

  <main class="max-w-4xl mx-auto p-6 bg-white rounded-3xl shadow-xl mt-12">
    <section id="opening-section" class="text-center transition-opacity duration-700 ease-in-out">
      <h1 class="text-6xl font-pacifico mb-6 gradient-text sparkle-pulse select-none">
        ğŸ‰ Happy Birthday Sakshii ğŸ‚ğŸ’–
      </h1>
      <p class="text-xl italic text-purple-700 max-w-2xl mx-auto mb-8">
        My dearest Sakshii, you are the brightest light in our lives. Thank you for your kindness, laughter, and for being the most incredible sister. Wishing you a day filled with all the joy you bri[...]
      </p>
      <p class="text-lg font-bold text-pink-600 mb-2">Youâ€™re the best sister ever! ğŸ’–âœ¨</p>
      <p class="text-base text-purple-600 animate-pulse mb-10">Wishing you smiles, sparkles, and lots of cake ğŸ‚ğŸˆ</p>
      <div class="flex justify-center items-center space-x-2">
        <button id="open-folder-btn" class="bg-gradient-to-r from-pink-500 to-purple-600 py-4 px-10 rounded-full text-white font-extrabold text-xl tracking-wider uppercase shadow-xl transition-transform select-none">
          Open Happy Folder ğŸ’Œ
        </button>
        <!-- Play link: user clicks this to explicitly start/unmute audio if needed -->
        <a id="play-music-link" href="#" role="button" aria-label="Play birthday music">Play Song â–¶ï¸</a>
        <span id="audio-feedback" aria-live="polite"></span>
      </div>
      <p class="text-sm text-gray-500 mt-3">If you still don't hear anything, click "Play Song" or tap anywhere on the page to allow sound (some browsers block autoplay with sound).</p>
    </section>

    <section id="happy-folder-section" class="hidden opacity-0 pt-12">
      <h2 class="text-3xl font-pacifico text-center text-gray-800 mb-10 select-none">
        Unfolding Sweetest Moments ğŸ“¸
      </h2>
      <div id="memory-flow-container" class="flex flex-col items-center space-y-6 max-w-xl mx-auto"></div>
      <div id="back-button-container" class="text-center mt-10">
        <button onclick="window.location.reload()" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-6 rounded-full transition-transform transform hover:scale-105 select-none">
          &larr; Start Over
        </button>
      </div>
    </section>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const confettiContainer = document.getElementById('confetti-container');
      const musicPlayer = document.getElementById('bday-music');
      const openFolderBtn = document.getElementById('open-folder-btn');
      const playMusicLink = document.getElementById('play-music-link');
      const openingSection = document.getElementById('opening-section');
      const happyFolderSection = document.getElementById('happy-folder-section');
      const memoryFlowContainer = document.getElementById('memory-flow-container');
      const backButtonContainer = document.getElementById('back-button-container');
      const body = document.body;
      const audioFeedback = document.getElementById('audio-feedback');

      const imageCount = 15;
      const captions = [
        "Sweet Memories ğŸ’•", "Best Moments ğŸ", "Love You Sis ğŸ’–", "Crazy Times ğŸ¥³", "Shine Bright âœ¨",
        "Priceless Laughter ğŸ˜‚", "Adventures Together ğŸŒ", "Forever Bonded â™¾ï¸"
      ];
      const imageElements = [];

      const imageSlides = [];
      for (let i = 1; i <= imageCount; i++) {
        imageSlides.push({
          src: `image${i}.jpg`,
          caption: captions[i % captions.length],
        });
      }

      // Add confetti
      function createConfetti() {
        for(let i = 0; i < 60; i++){
          let confetti = document.createElement('div');
          confetti.className = 'confetti';
          confetti.style.left = Math.random() * 100 + 'vw';
          confetti.style.top = -Math.random() * 20 + 'vh';
          confetti.style.backgroundColor = ['#ff7e5f','#feb47b','#a78bfa','#ffb7c7'][Math.floor(Math.random()*4)];
          confetti.style.animationDelay = Math.random() * 8 + 's';
          confetti.style.width = (Math.random()*7 + 5) + 'px';
          confetti.style.height = confetti.style.width;
          confettiContainer.appendChild(confetti);
        }
      }
      createConfetti();

      // Sequentially add images horizontally alternating sides, scrolling page up as images come
      function createMemoryCard(i) {
        const memory = imageSlides[i-1];
        let card = document.createElement('div');
        card.className = 'memory-card flex items-center space-x-4 px-6 py-3 rounded-2xl bg-white shadow-md transform opacity-0 transition-opacity duration-700 ease-in-out';
        card.style.animationFillMode = 'forwards';
        card.style.animationDuration = '0.8s';
        card.style.animationTimingFunction = 'cubic-bezier(0.36, 0.66, 0.04, 1)';
        card.classList.add(i % 2 === 1 ? 'row-left' : 'row-right');
        if(i % 2 === 0) card.classList.add('flex-row-reverse');

        const img = document.createElement('img');
        img.src = memory.src;
        img.alt = `Memory ${i} - Sakshii`;
        img.className = 'slide-img';

        const caption = document.createElement('p');
        caption.className = 'caption';
        caption.textContent = memory.caption;

        card.appendChild(img);
        card.appendChild(caption);

        memoryFlowContainer.appendChild(card);
        imageElements.push(card);

        setTimeout(() => {
          card.style.opacity = '1';
          card.style.animationName = i % 2 === 1 ? 'slideInLeft' : 'slideInRight';
          card.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 50);
      }

      async function animateImagesSequentially(){
        for(let i = 1; i <= imageCount; i++){
          createMemoryCard(i);
          await new Promise(res => setTimeout(res, 2000));
        }
        setTimeout(showFinalCollage, 2500);
      }

      function showFinalCollage(){
        happyFolderSection.classList.add('hidden');
        backButtonContainer.classList.add('hidden');
        memoryFlowContainer.classList.add('collage-grid', 'blinking-collage');
        memoryFlowContainer.classList.remove('flex-col', 'space-y-6');
        body.classList.add('overflow-hidden');

        imageElements.forEach(card => {
          card.classList.remove('row-left', 'row-right', 'flex-row-reverse', 'opacity-0');
          card.style.animation = 'none';
          card.style.opacity = '1';
          const img = card.querySelector('img');
          if(img) img.style.borderRadius = '0';
          const caption = card.querySelector('.caption');
          if(caption) caption.style.display = 'none';
        });

        // Overlay message
        let overlay = document.createElement('div');
        overlay.className = 'overlay-message';
        overlay.innerHTML = `<p>Forever Loved, Sakshii! â¤ï¸</p>`;
        body.appendChild(overlay);
      }

      // Helper to explicitly start/unmute music with proper user gesture.
      async function startMusic(options = {}) {
        try {
          if (typeof options.volume === 'number') {
            musicPlayer.volume = Math.max(0, Math.min(1, options.volume));
          } else {
            musicPlayer.volume = 0.8;
          }
          musicPlayer.muted = !!options.muted;
          if (options.restart) musicPlayer.currentTime = 0;
          await musicPlayer.play();
          return Promise.resolve();
        } catch (err) {
          return Promise.reject(err);
        }
      }

      // Try to autoplay on load (muted). Most browsers allow muted autoplay.
      // We already set autoplay and muted attributes on the audio element; attempt play to be sure.
      (async function tryAutoplayMuted() {
        try {
          await musicPlayer.play();
          audioFeedback.textContent = '';
        } catch (e) {
          // If autoplay fails, leave muted and provide UI to start.
          audioFeedback.textContent = 'Autoplay blocked â€” tap to enable sound.';
        }
      })();

      // If user interacts anywhere on the page, unmute and set volume (common pattern).
      // This makes audible playback possible after a user gesture.
      function onFirstInteraction() {
        // Unmute and raise volume, then try to play
        startMusic({ volume: 0.9, muted: false, restart: false })
          .then(() => {
            audioFeedback.textContent = 'Audio enabled â€” enjoy the music!';
            playMusicLink.textContent = 'Playing â–¶ï¸';
            setTimeout(() => { playMusicLink.style.display = 'none'; }, 1200);
          })
          .catch((err) => {
            console.warn('Could not unmute on interaction:', err);
            audioFeedback.textContent = 'Tap the "Play Song" button to allow audio.';
          });
        // Remove listeners after first interaction to avoid repeated attempts
        window.removeEventListener('click', onFirstInteraction);
        window.removeEventListener('touchstart', onFirstInteraction);
      }

      window.addEventListener('click', onFirstInteraction, { once: true });
      window.addEventListener('touchstart', onFirstInteraction, { once: true });

      // Primary "Open Happy Folder" button behavior â€” still attempts to play but doesn't replace explicit play link
      openFolderBtn.addEventListener('click', () => {
        // Try to play music with reduced chance of being blocked since it's a user gesture as part of click.
        startMusic({ volume: 0.6, muted: false }).catch(() => {});
        openingSection.classList.add('opacity-0');
        setTimeout(() => {
          openingSection.classList.add('hidden');
          happyFolderSection.classList.remove('hidden');
          setTimeout(() => {
            happyFolderSection.classList.remove('opacity-0');
            animateImagesSequentially();
          }, 50);
        }, 700);
        openFolderBtn.disabled = true;
      });

      // Explicit play link: ensures music starts when user clicks the link. This is the most reliable way to make audio audible.
      playMusicLink.addEventListener('click', async (e) => {
        e.preventDefault();
        audioFeedback.textContent = '';
        try {
          if (!musicPlayer.src || musicPlayer.src.trim() === '') {
            audioFeedback.textContent = 'No audio file found â€” check path.';
            return;
          }
          await startMusic({ volume: 0.9, muted: false, restart: true });
          playMusicLink.textContent = 'Playing â–¶ï¸';
          playMusicLink.style.opacity = '0.9';
          audioFeedback.textContent = 'Playing â€” enjoy the song!';
          setTimeout(() => { playMusicLink.style.display = 'none'; }, 1200);
        } catch (err) {
          console.warn('Playback blocked:', err);
          playMusicLink.textContent = 'Click again to allow sound';
          audioFeedback.textContent = 'Playback blocked by browser. Try clicking the audio controls or tap again.';
        }
      });

      // If you want the audio to stop when user navigates away, pause on unload (optional)
      window.addEventListener('pagehide', () => {
        try { musicPlayer.pause(); } catch (e) {}
      });
    });
  </script>
</body>
</html>
